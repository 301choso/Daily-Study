### 서블릿
서블릿은 서버에서 처리해야할 업무 일부를 대신 해준다.(비즈니스 로직 제외하고)  
TCP/IP연결, 요청메시지 파싱, 응답메시지 생성 등

요청, 응답객체는 매번 생성하지만 서블릿은 재사용하고, 싱글톤으로 관리하므로
공유변수 사용에 주의하도록 한다.

### 멀티쓰레드 
WAS안에서 요청이 들어오면 쓰레드가 서블릿을 호출하는 역할을 한다.  
이 때 쓰레드가 할당되는 것에서 요청마다 생성되도록 하면  

__장점__ : 리소스 허용될 때까지 생성, 동시에 처리가 가능함  
__단점__ : 비용이 비쌈, 속도가 느림(생성해야 하므로), 컨텍트 스위칭 비용 발생, 메모리 임계점 넘겨 서버가 죽을수도 있음

__해결__ : 쓰레드 풀! 미리 만들어 놓고 할당했다가 반납하게 함  
쓰레드 최대치 사용하면? 대기 또는 거절 상태 설정 가능  
 * 미리 생성되어 있어 생성 및 종료비용 절약
 * 응답시간 빠름
 * 많은 요청 들어와도 안전하게 처리가능

주요 튜닝 포인트는 __최대 쓰레드(max thread) 수__ 이다. 

쓰레드풀 너무 낮게 설정시 : 동시요청 많으면 WAS는 살아있으나 대기 중이므로 서비스 장애(응답 지연)
쓰레드풀 너무 높게 설정시 : 동시요청 많으면 CPU, 메모리 리소스 임계점 초과로 서버 다운

어플리케이션 로직의 복잡도, CPU, 메모리, IO리소스 상황에 따라 다르다.
그렇다면 적정 숫자는 어떻게 찾아야 하나?  
최대한 실제 서비스와 유사하게 __성능 테스트 시도하여 찾는다.__  
툴 : 아파치ab, 제이미터, nGrinder

장애 발생 시?  
클라우드면 일단 서버부터 늘리고 이후에 튜닝
클라우드 아니면 열심히 튜닝

__그런데 WAS가 지원하므로 개발자는 멀티쓰레드 신경쓰지 않아도 된다.__
